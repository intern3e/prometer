<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ICON -->
  <link rel="icon" type="image/png" href="https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png" />

  
  <title>myFlukeTH — เครื่องมืออุตสาหกรรม FLUKE |(Fluke Thailand)</title>
  <meta name="description"
        content="ศูนย์รวมเครื่องมือวัดไฟฟ้า FLUKE — คาลิเบรตมาตรฐานสากล | สอบถาม 066-097-5697 (คุณผักบุ้ง) | info@hikaripower.com | LINE @hikaridenki">
  <meta name="keywords"
        content="myfluketh, myfluke, fluketh, fluke, fluke thailand, เครื่องมือวัดไฟฟ้า, ฟลุค, ฟลุคไทย, มัลติมิเตอร์, แคลมป์มิเตอร์, คาลิเบรต, Hikari Power">
  <meta name="author" content="myFlukeTH">
  <!-- แทนที่ include ด้วย meta ตรง ๆ เพื่อหน้าเดียวจบ -->
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://myfluketh.com/">

  
  <meta name="google-site-verification" content="tpmhTAxPUzD7bh4163L-tqG21SpSCOJC_N0nNxfNt3k" />

  
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="myFlukeTH">
  <meta property="og:title" content="myFlukeTH — เครื่องมืออุตสาหกรรม FLUKE |(Fluke Thailand)">
  <meta property="og:description"
        content="ศูนย์รวมเครื่องมือวัดไฟฟ้า FLUKE — คาลิเบรตมาตรฐานสากล | สอบถาม 066-097-5697 (คุณผักบุ้ง) | info@hikaripower.com | LINE @hikaridenki">
  <meta property="og:url" content="https://myfluketh.com/">
  <meta property="og:image" content="https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:locale" content="th_TH">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="myFlukeTH — เครื่องมืออุตสาหกรรม FLUKE |(Fluke Thailand)">
  <meta name="twitter:description"
        content="ศูนย์รวมเครื่องมือวัดไฟฟ้า FLUKE — คาลิเบรตมาตรฐานสากล | สอบถาม 066-097-5697 (คุณผักบุ้ง) | info@hikaripower.com | LINE @hikaridenki">
  <meta name="twitter:image" content="https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png">
  <meta name="twitter:image:alt" content="myFlukeTH — ศูนย์รวมเครื่องมือวัดไฟฟ้า FLUKE">

  
  <link rel="icon" type="image/png" href="https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />

  
    <style>
    .sr-only{
      position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;
      clip:rect(0,0,0,0);white-space:nowrap;border:0
    }
  </style>
  
  
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","url":"https://myfluketh.com/","name":"myFlukeTH","alternateName":["myfluketh","myfluke","fluketh","Fluke Thailand","ฟลุค"],"description":"ศูนย์รวมเครื่องมือวัดไฟฟ้า FLUKE — คาลิเบรตมาตรฐานสากล | สอบถาม 066-097-5697 (คุณผักบุ้ง)","potentialAction":{"@type":"SearchAction","target":"https://myfluketh.com/?q={search_term_string}","query-input":"required name=search_term_string"},"publisher":{"@type":"Organization","name":"Hikari Power","logo":"https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png","url":"https://myfluketh.com/"},"sameAs":["https://www.facebook.com/hikaridenki","https://line.me/R/ti/p/@hikaridenki"]}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","name":"myFlukeTH","alternateName":["myfluketh","myfluke","fluketh"],"url":"https://myfluketh.com/","logo":"https://img5.pic.in.th/file/secure-sv1/ChatGPT_Image_18_.._2568_12_03_57-removebg-preview.png","sameAs":["https://www.facebook.com/hikaridenki","https://line.me/R/ti/p/@hikaridenki"],"contactPoint":[{"@type":"ContactPoint","telephone":"+66660975697","contactType":"customer service","areaServed":"TH","availableLanguage":["Thai","English"]}]}</script>
</head>
<body>
  <!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSRF (เผื่อคุณมีเอ็นด์พอยต์เพิ่มตะกร้า จะได้ใช้ได้ทันที) -->
  <meta name="csrf-token" content="qJ1lx07sd9fDMVB6nxRtgv0QgMJ34Rd2xHSBiMDV">

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Swiper -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>

  <style>
  :root{
    --brand:#ff6a00;
    --ink:#111827;
    --card:#ffffff;
    --bg:#f3f4f6;
    --radius:16px;
  }
  
  html, body { height: 100%; margin: 0; overscroll-behavior: none; }
  body{ font-family:'Prompt',sans-serif; background:var(--bg); color:var(--ink); }
  .container-outer{ max-width:1200px; margin:0 auto; }
  .section-pad{ padding-left:.75rem; padding-right:.75rem; }
  @media (min-width:768px){ .section-pad{ padding-left:1rem; padding-right:1rem; } }
  .lift{ transition:transform .2s ease, box-shadow .2s ease; }
  .lift:hover{ transform:translateY(-2px); box-shadow:0 6px 18px rgba(0,0,0,.08); }
  .transition-fast{ transition:all .2s ease; }
  .fade-in{ opacity:0; transform:translateY(6px); transition:all .18s ease; }
  .group:hover .fade-in{ opacity:1; transform:translateY(0); }
  .left-cat a{ display:block; border-radius:10px; padding:6px 8px; transition:background .2s ease,color .2s ease; }
  .left-cat li{ padding:2px 0; }
  .left-cat a:hover{ background:#fff5ef; color:var(--brand); }
  .card{
    background:var(--card);
    border:1px solid rgba(17,24,39,.08);
    border-radius:var(--radius);
    box-shadow:0 1px 2px rgba(0,0,0,.04);
    transition:box-shadow .2s ease, border-color .2s ease;
  }
  .card:hover{ box-shadow:0 4px 14px rgba(0,0,0,.07); }
  .btn-brand{ background:#facc15; color:#fff; border-radius:8px; padding:.5rem 1rem; font-weight:600; }
  .btn-brand:hover{ filter:brightness(0.95); }
  .promo-pro{
    display:grid; grid-template-columns:64px 1fr 28px; align-items:center;
    min-height:110px; padding:14px 16px; gap:16px; border-radius:var(--radius);
    border:1px solid rgba(17,24,39,.08); background:#fff; position:relative; overflow:hidden;
    box-shadow:0 1px 2px rgba(0,0,0,.04);
    transition:box-shadow .2s ease, transform .2s ease, border-color .2s ease;
  }
  .promo-pro:hover{ box-shadow:0 6px 18px rgba(0,0,0,.08); transform:translateY(-1px); border-color:rgba(17,24,39,.12); }
  .promo-icon{ width:56px; height:56px; border-radius:14px; display:flex; align-items:center; justify-content:center; }
  .promo-col{ display:grid; grid-template-rows:repeat(2,minmax(0,1fr)); height:100%; gap:16px; }
  .cat-card img{ width:100%; height:auto; object-fit:cover; object-position:center; display:block; }
  .cat-caption{ background:#fff; text-align:center; padding:.6rem 0; color:#374151; font-weight:600; }
  .lang-item{ cursor:pointer; }

  /* ปิด badge ปลอมที่ธีมบางตัวเติม "::after: '0'" */
  .nav-cart .bi-cart::after { content: none !important; }

  /* เอฟเฟกต์เด้งเบา ๆ ตอนจำนวนเปลี่ยน */
  @keyframes cartPop { 0% { transform: scale(1); } 30% { transform: scale(1.2); } 100% { transform: scale(1); } }
  #cartCountDb.cart-pop { animation: cartPop .25s ease-out; }
  </style>

  <style>
  @media (max-width: 767px){
    #mobileSearch .tt-menu,
    #mobileSearch .autocomplete-suggestions,
    #mobileSearch .awesomplete ul,
    #mobileSearch .ais-SearchBox-suggestions,
    #mobileSearch #searchResultsMobile{
      position: absolute;
      top: calc(100% + 8px);
      left: 0; right: 0;
      max-height: 65vh;
      overflow: auto;
      z-index: 90;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
    }
  }
  </style>
</head>
<body>

<!-- ===== Top utility bar (one-line on mobile) ===== -->
<style>
  /* ปรับให้บาร์นี้บีบตัวเองบนจอเล็ก */
  .utilbar{ font-size:12px; }
  @media (min-width:768px){ .utilbar{ font-size:13px; } }

  /* ตัวช่วยตัดข้อความแบบ inline */
  .inline-clip{
    display:inline-block; max-width:100%;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    vertical-align:bottom;
  }
</style>

<header class="bg-gray-100 text-gray-700 border-b utilbar">
  <!-- flex-nowrap บังคับบรรทัดเดียวบนมือถือ / min-w-0 ช่วย truncate -->
  <div class="container-outer mx-auto section-pad py-1.5 flex items-center justify-between gap-2 flex-nowrap min-w-0">
    <!-- ซ้าย -->
    <div class="flex items-center gap-3 whitespace-nowrap shrink-0">
<a href="tel:+66660975697"
   class="hover:text-[var(--brand)]"
   data-i18n="[aria-label]top_buyer_central"
   aria-label="Buyer Central">
   <i class="bi bi-telephone"></i> 066-097-5697 
   <span class="hidden md:inline text-black/75">(คุณ ผักบุ้ง)</span>
</a>

   
 <a id="lineBtn"
   href="line://ti/p/@543ubjtx"
   class="hover:text-white"
   style="background-color:#06C755; color:white; padding:2px 8px; border-radius:4px; text-decoration:none;"
   data-i18n="[aria-label]top_help"
   aria-label="Help (LINE @543ubjtx)">
   LINE
</a>


<script>
(function () {
  const deep = 'line://ti/p/@543ubjtx';
  const web  = 'https://line.me/R/ti/p/@543ubjtx';

  const btn = document.getElementById('lineBtn');
  if (!btn) return;

  btn.addEventListener('click', function (e) {
    e.preventDefault();
    const start = Date.now();
    // พยายามเปิดแอป LINE
    window.location.href = deep;

    // ถ้าไม่มีแอปรองรับ ให้ดีดไปหน้าเว็บภายใน ~1.2s
    setTimeout(function () {
      if (Date.now() - start < 1500) {
        window.location.href = web;
      }
    }, 1200);
  }, { passive: false });
})();
</script>

<noscript>
  <!-- เผื่อปิด JS ไว้ จะกดไปเว็บได้ -->
  <a href="https://line.me/R/ti/p/@543ubjtx">@543ubjtx</a>
</noscript>


    </div>

    <!-- ขวา -->
    <div class="flex items-center gap-2 min-w-0 whitespace-nowrap flex-1 justify-end">
      <!-- ภาษา -->
      <div class="relative shrink-0">
        <button id="currentLangBtn" class="flex items-center gap-1 px-2 py-1 rounded border border-gray-200 hover:bg-orange-50">
          <span id="currentLangLabel" class="inline-clip" style="max-width:64px">ไทย</span>
          <i class="bi bi-chevron-down text-[10px]"></i>
        </button>
        <div id="langDropdown" class="absolute right-0 top-full mt-2 w-36 bg-white rounded shadow hidden z-50">
          <div class="px-3 py-2 text-xs text-gray-500" data-i18n="top_choose_lang">เลือกภาษา</div>
          <div class="border-t">
            <div class="lang-item px-4 py-2 hover:bg-orange-50" data-lang="ไทย">ไทย</div>
            <div class="lang-item px-4 py-2 hover:bg-orange-50" data-lang="English">English</div>
          </div>
        </div>
      </div>


      <!-- ปุ่ม Login/Register จะไม่ดันตกบรรทัด -->
      <a href="http://127.0.0.1:8000/login" class="hover:text-[var(--brand)] shrink-0" data-i18n="top_login">เข้าสู่ระบบ</a>
      <a href="http://127.0.0.1:8000/Sign_up" class="hover:text-[var(--brand)] shrink-0" data-i18n="top_join_free">สมัครสมาชิกฟรี</a>
    </div>
  </div>
</header>


    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('userMenuBtn');
    const dd  = document.getElementById('userMenuDropdown');
    if (!btn || !dd) return;

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      dd.classList.toggle('hidden');
      btn.setAttribute('aria-expanded', dd.classList.contains('hidden') ? 'false' : 'true');
    });

    document.addEventListener('click', (e) => {
      if (!dd.contains(e.target) && !btn.contains(e.target)) {
        dd.classList.add('hidden');
        btn.setAttribute('aria-expanded', 'false');
      }
    });
  });
</script>

<nav class="bg-white border-b sticky top-0 z-[40]" role="navigation" aria-label="Primary">
  <div class="container-outer mx-auto section-pad py-3 md:py-4 flex items-center gap-2 md:gap-6">

    <!-- Mobile: hamburger -->
    <button class="md:hidden p-2 rounded-lg border text-gray-700"
            aria-label="Open menu" aria-controls="mobileMenu" aria-expanded="false"
            data-drawer-toggle="#mobileMenu">
      <i class="bi bi-list text-xl"></i>
    </button>

    <!-- Brand -->
    <a href="/" class="flex items-center gap-2 min-w-0">
          <img src="https://img2.pic.in.th/pic/image032196d0b157d229.png" 
              alt="FLUKE" 
              class="h-8 md:h-10 w-auto" 
              data-i18n="brand_name">
        </a>

    <!-- Desktop: All Categories (mega menu) -->
    <div class="hidden md:block">
      <div class="relative" aria-haspopup="true">
        <button id="toggleMegaMenu"
                class="px-4 py-2 border rounded-lg text-sm font-medium flex items-center gap-2
                       hover:border-[var(--brand)] hover:bg-gray-50
                       focus:outline-none focus:ring-2 focus:ring-[var(--brand)] transition"
                aria-expanded="false">
          <i class="bi bi-list text-lg" aria-hidden="true"></i>
          <span data-i18n="nav_all_categories">หมวดหมู่ทั้งหมด</span>
        </button>

        <div id="megaMenu"
             class="hidden absolute mt-3 w-[760px] bg-white shadow-2xl rounded-xl p-6 grid grid-cols-3 gap-6 z-50"
             role="menu">
          <!-- Column 1 -->
          <div>
            <h4 class="text-gray-900 font-semibold mb-3 text-base border-b pb-1" data-i18n="mega_measure">เครื่องมือวัด</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="http://127.0.0.1:8000/products/category/ClampMeter1" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_1">แคลมป์มิเตอร์</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/Multimeters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_2">มัลติมิเตอร์</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/ElectricalTesters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_3">เครื่องทดสอบไฟฟ้า</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/InsulationTesters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_4">เครื่องวัดฉนวน</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/Thermography" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_5">กล้องถ่ายภาพความร้อน</a></li>
            </ul>
          </div>

          <!-- Column 2 -->
          <div>
            <h4 class="text-gray-900 font-semibold mb-3 text-base border-b pb-1" data-i18n="mega_process">กระบวนการ/สอบเทียบ</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="http://127.0.0.1:8000/products/category/LoopCalibrators" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p1">เครื่องสอบเทียบลูป</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/CalibrationTools" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p2">เครื่องสอบเทียบความดัน</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/Temperature" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p3">เครื่องสอบเทียบอุณหภูมิ</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/ProcessCalibrators" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p4">เครื่องสอบเทียบกระบวนการ</a></li>
            </ul>
          </div>

          <!-- Column 3 -->
          <div>
            <h4 class="text-gray-900 font-semibold mb-3 text-base border-b pb-1" data-i18n="mega_accessories">อุปกรณ์เสริม</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="http://127.0.0.1:8000/products/category/TestLeadsProbes" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a1">สายวัดและโพรบ</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/BatteriesChargers" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a2">แบตเตอรี่และชาร์จ</a></li>
              <li><a href="http://127.0.0.1:8000/products/category/ToolCases" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a3">กล่องเก็บเครื่องมือ</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      const toggleBtn = document.getElementById('toggleMegaMenu');
      const megaMenu = document.getElementById('megaMenu');
      if (toggleBtn && megaMenu) {
        toggleBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          megaMenu.classList.toggle('hidden');
          toggleBtn.setAttribute('aria-expanded', megaMenu.classList.contains('hidden') ? 'false' : 'true');
        });
        document.addEventListener('click', (e) => {
          if (!megaMenu.contains(e.target) && !toggleBtn.contains(e.target)) {
            megaMenu.classList.add('hidden');
            toggleBtn.setAttribute('aria-expanded', 'false');
          }
        });
      }
    </script>

    <!-- Desktop: Search -->
    <div class="hidden md:flex flex-1">
      <label for="globalSearch" class="sr-only">Search</label>
      <div class="relative w-full">
        <div class="flex border rounded-md bg-white w-full focus-within:ring-2 focus-within:ring-[var(--brand)]">
          <input id="globalSearch" type="text" class="flex-1 px-3 py-2 outline-none"
                 data-i18n="search_placeholder" data-i18n-attr="placeholder"
                 placeholder="คุณต้องการให้เราช่วยค้นหาอะไร" />
          <button class="px-3" aria-label="Submit search">
            <i class="bi bi-search text-lg"></i>
          </button>
        </div>
        <div id="searchResultsDesktop"
             class="absolute left-0 right-0 top-[calc(100%+8px)] hidden bg-white rounded-xl shadow-xl z-[60]"></div>
      </div>
    </div>

    <!-- Mobile: Search icon -->
    <button class="md:hidden p-2 rounded-lg border text-gray-700 ml-auto"
            aria-controls="mobileSearch" aria-expanded="false" aria-label="Open search"
            data-collapse-toggle="#mobileSearch">
      <i class="bi bi-search text-lg"></i>
    </button>

<!-- Cart (robust: Auth + session + fallback + guard) -->

<a href="http://127.0.0.1:8000/cart" class="nav-cart relative text-gray-700 hover:text-[var(--brand,#ff6a00)] ml-1" aria-label="cart">
  <i class="bi bi-cart text-2xl"></i>
  <span
    id="cartCountDb"
    data-cart-badge
    data-count="0"
    aria-live="polite" aria-atomic="true"
    class="absolute -top-2 -right-2 bg-[var(--brand,#ff6a00)] text-white text-xs rounded-full min-w-5 h-5 px-1 flex items-center justify-center"
    style="z-index:60">0</span>
</a>

<style>
@keyframes cartPop { 0%{transform:scale(1)} 50%{transform:scale(1.15)} 100%{transform:scale(1)} }
.cart-pop { animation: cartPop .3s ease; }
</style>

<script>
(function(){
  // ================= Config =================
  // ระบุ pattern ของ endpoint เพิ่มสินค้าตะกร้าที่หน้าอื่นอาจเรียกใช้อยู่
  // เติมลิสต์คำที่เจอบ่อย ๆ ไว้แล้ว เช่น /cart/add, /add-to-cart
  const CART_MATCH = /(\/cart\/add|\/add-?to-?cart)/i;

  // ================ Badge ===================
  const BADGES = Array.from(document.querySelectorAll('[data-cart-badge], #cartCountDb'));
  if (!BADGES.length) return;

  const toInt = (v, d=0) => { const n = parseInt(v,10); return Number.isFinite(n) ? n : d; };

  const get = () =>
    BADGES.reduce((m, b) => Math.max(m, toInt(b.dataset.count ?? b.textContent ?? '0', 0)), 0);

  const setAll = (n, {pop=true} = {}) => {
    const v = String(Math.max(0, toInt(n, 0)));
    BADGES.forEach(b => {
      b.dataset.count = v;
      if (b.textContent !== v) {
        b.textContent = v;
        if (pop) { b.classList.remove('cart-pop'); void b.offsetWidth; b.classList.add('cart-pop'); }
      }
    });
    window.dispatchEvent(new CustomEvent('cart:count:changed', { detail: { count: toInt(v,0) } }));
  };

  // ================ Public API ==============
  window.setCartCount  = (n, opts={}) => setAll(n, opts);
  window.bumpCartCount = (delta=1) => setAll(Math.max(0, get() + toInt(delta,0)));
  window.cartAdded     = (qty=1) => window.bumpCartCount(qty); // เผื่อเรียกเองจากโค้ดอื่น

  // ============== Smart Auto-bind ===========
  const findQtyNear = (btn) => {
    const scope = btn.closest('[data-product], [data-card], .product, .card, .item, form') || document;
    const qEl = btn.getAttribute('data-qty') ? null :
      scope.querySelector('[data-qty-input], input[name="quantity"], input.qty, .qty input');
    return toInt(btn.getAttribute('data-qty') ?? (qEl ? qEl.value : 1), 1);
  };

  const extractIdFrom = (el) => {
    const direct = el.getAttribute('data-iditem') ?? el.dataset.id ?? el.value ?? '';
    if (direct) return String(direct).trim();
    const scope = el.closest('[data-product], [data-card], .product, .card, .item, form') || document;
    const holder =
      scope.querySelector('[data-iditem], [data-product-id], [data-id]') ||
      scope.querySelector('input[name="iditem"], input[name="product_id"], input[name="id"]');
    if (holder) {
      const v = holder.getAttribute('data-iditem') ?? holder.getAttribute('data-product-id') ?? holder.getAttribute('data-id') ?? holder.value;
      if (v) return String(v).trim();
    }
    const a = el.closest('a[href]');
    if (a) {
      try {
        const u = new URL(a.href, location.origin);
        const q = u.searchParams.get('iditem') || u.searchParams.get('id');
        if (q) return String(q).trim();
      } catch {}
    }
    return '';
  };

  const extractApiFrom = (el) => {
    const api = el.getAttribute('data-api');
    if (api) return api;
    const a = el.closest('a[href]');
    if (a && CART_MATCH.test(a.getAttribute('href'))) return a.href;
    const form = el.closest('form[action]');
    if (form && CART_MATCH.test(form.getAttribute('action'))) return form.getAttribute('action');
    return null;
  };

  const extractMethodFrom = (el) => {
    const m = (el.getAttribute('data-method') || '').toUpperCase();
    if (m) return m;
    const form = el.closest('form');
    if (form && form.method) return form.method.toUpperCase();
    return 'POST';
  };

  // คลิก (ใช้ capture เพื่อชนะสคริปต์ที่ stopPropagation)
  document.addEventListener('click', async (e) => {
    const btn = e.target.closest('[data-add-to-cart], .add-to-cart, a[href*="/cart/add"], a[href*="add-to-cart"]');
    if (!btn) return;
    e.preventDefault();

    const id     = extractIdFrom(btn); // ไม่มี id ก็ยังเด้งเลขได้
    const qty    = findQtyNear(btn);
    const api    = extractApiFrom(btn);
    const method = extractMethodFrom(btn);

    await window.cartAdd(id, qty, api ? { api, method } : {});
  }, true); // <= capture true

  // submit form (capture true)
  document.addEventListener('submit', async (e) => {
    const form = e.target.closest('form');
    if (!form) return;
    const action = form.getAttribute('action') || '';
    const marked = form.matches('[data-add-to-cart-form]');
    if (!marked && !CART_MATCH.test(action)) return;

    e.preventDefault();

    const idInput = form.querySelector('input[name="iditem"], input[name="product_id"], input[name="id"]');
    const qtyInput= form.querySelector('[data-qty-input], input[name="quantity"], input.qty, .qty input');

    const id     = idInput?.value || '';
    const qty    = toInt(qtyInput?.value ?? 1, 1);
    const api    = action || null;
    const method = (form.method || 'POST').toUpperCase();

    await window.cartAdd(id, qty, api ? { api, method } : {});
  }, true);

  // =========== Intercept fetch / XHR =========
  // ครอบ fetch เพื่อดักการเรียก /cart/add ของสคริปต์อื่น ๆ
  if (!window.__cartFetchPatched) {
    window.__cartFetchPatched = true;
    const _fetch = window.fetch;
    window.fetch = async function(input, init={}) {
      const url = (typeof input === 'string') ? input : (input?.url || '');
      const method = (init?.method || (typeof input !== 'string' ? input.method : 'GET') || 'GET').toUpperCase();
      const isCartAdd = CART_MATCH.test(url);

      // เริ่ม: ถ้าเป็น add → optimistic (+1 ถ้าเดา qty ไม่ได้)
      let guessedQty = 1;
      if (isCartAdd) {
        try {
          if (init && init.body && typeof init.body === 'string' && init.headers && /json/i.test(init.headers['Content-Type'] || init.headers['content-type'] || '')) {
            const j = JSON.parse(init.body); guessedQty = toInt(j.quantity ?? j.qty ?? 1, 1);
          }
        } catch {}
        window.cartAdded(guessedQty);
      }

      const res = await _fetch(input, init);
      if (isCartAdd) {
        try {
          // พยายามอ่าน count จากผลลัพธ์
          const clone = res.clone();
          const type = clone.headers.get('content-type') || '';
          if (/application\/json/i.test(type)) {
            const data = await clone.json();
            if (typeof data?.count !== 'undefined') window.setCartCount(data.count);
          }
        } catch {}
      }
      return res;
    };
  }

  // ครอบ XMLHttpRequest เช่นกัน
  if (!window.__cartXHRPatched) {
    window.__cartXHRPatched = true;
    const _open = XMLHttpRequest.prototype.open;
    const _send = XMLHttpRequest.prototype.send;
    XMLHttpRequest.prototype.open = function(method, url, async, user, password) {
      this.__cart_isAdd = CART_MATCH.test(url || '');
      this.__cart_method = (method || 'GET').toUpperCase();
      return _open.apply(this, arguments);
    };
    XMLHttpRequest.prototype.send = function(body) {
      if (this.__cart_isAdd) {
        let guessedQty = 1;
        try {
          if (typeof body === 'string') {
            // ลองเดาจาก JSON
            const j = JSON.parse(body);
            guessedQty = toInt(j.quantity ?? j.qty ?? 1, 1);
          }
        } catch {}
        window.cartAdded(guessedQty);

        this.addEventListener('load', () => {
          try {
            const type = this.getResponseHeader('content-type') || '';
            if (/application\/json/i.test(type)) {
              const data = JSON.parse(this.responseText);
              if (typeof data?.count !== 'undefined') window.setCartCount(data.count);
            }
          } catch {}
        });
      }
      return _send.apply(this, arguments);
    };
  }

  // ============== cartAdd core =============
  window.cartAdd = async function(iditem, qty=1, options={}) {
    const q  = Math.max(1, toInt(qty, 1));
    const id = (iditem ?? '').toString().trim();

    // optimistic
    window.cartAdded(q);

    const api    = options.api || null;
    const method = (options.method || 'POST').toUpperCase();
    if (!api) return;

    try {
      const token  = document.querySelector('meta[name="csrf-token"]')?.content;
      const payload = method === 'GET' ? undefined : JSON.stringify({ iditem: id, quantity: q });

      const res = await fetch(api, {
        method,
        headers: {
          'Content-Type': 'application/json',
          'X-Requested-With': 'XMLHttpRequest',
          ...(token ? { 'X-CSRF-TOKEN': token } : {})
        },
        body: payload
      });

      // (fetch ถูกครอบด้านบนไว้อยู่แล้ว จะ sync count ให้อัตโนมัติถ้ามี)
      // เผื่อ API ไม่คืน JSON → ไม่เป็นไร คงค่า optimistic
      return res;
    } catch (e) {
      // ล้มเหลว: คงค่า optimistic ไว้
      return null;
    }
  };

  // เริ่มต้นจัดค่าให้ตรงกับ SSR
  setAll(get(), {pop:false});

  // กันสคริปต์อื่นเขียนทับ textContent
  BADGES.forEach(badge => {
    new MutationObserver(() => {
      const v = String(badge.dataset.count ?? '0');
      if (badge.textContent !== v) badge.textContent = v;
    }).observe(badge, { childList: true, characterData: true, subtree: true });
  });
})();
</script>

  </div>

  <!-- Mobile: Search bar -->
  <div id="mobileSearch" class="md:hidden hidden border-t relative z-[80]">
    <div class="container-outer mx-auto section-pad py-3">
      <label for="mobileSearchInput" class="sr-only">Search</label>
      <div class="relative w-full">
        <div class="flex border rounded-md bg-white w-full focus-within:ring-2 focus-within:ring-[var(--brand)]">
          <input id="mobileSearchInput" type="text" class="flex-1 px-3 py-2 outline-none"
                 data-i18n="search_placeholder" data-i18n-attr="placeholder"
                 placeholder="คุณต้องการให้เราช่วยค้นหาอะไร" />
          <button class="px-3" aria-label="Submit search">
            <i class="bi bi-search text-lg"></i>
          </button>
        </div>
        <div id="searchResultsMobile"
             class="absolute left-0 right-0 top-[calc(100%+8px)] hidden bg-white rounded-xl shadow-xl z-[90]"></div>
      </div>
    </div>
  </div>

  <!-- Mobile: Off-canvas categories -->
  <div id="mobileMenu" class="md:hidden fixed inset-0 z-[100] hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-black/40" data-drawer-close="#mobileMenu" aria-hidden="true"></div>
    <aside class="absolute right-0 top-0 h-full w-11/12 max-w-sm bg-white shadow-xl translate-x-full transition-transform"
           role="dialog" aria-modal="true" aria-label="Categories">
      <div class="flex items-center justify-between p-4 border-b">
        <div class="flex items-center gap-2">
          <i class="bi bi-list"></i>
          <span class="font-semibold" data-i18n="nav_all_categories">หมวดหมู่ทั้งหมด</span>
        </div>
        <button class="p-2 rounded-lg hover:bg-gray-100" aria-label="Close menu" data-drawer-close="#mobileMenu">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>

      
      <script>
      (function(){
        const SEARCH_URL = "http://127.0.0.1:8000/search/products";
        const EXCHANGE   = 38; // THB per USD

        const targets = [
          { input: document.getElementById('globalSearch'),       results: document.getElementById('searchResultsDesktop') },
          { input: document.getElementById('mobileSearchInput'),  results: document.getElementById('searchResultsMobile')  }
        ].filter(x => x.input && x.results);

        if (!targets.length) return;

        const getLang = () =>
          localStorage.getItem('site_lang') ||
          localStorage.getItem('preferredLanguage') || 'ไทย';

        const fmtTHB = v =>
          new Intl.NumberFormat('th-TH', { style:'currency', currency:'THB', maximumFractionDigits:0 }).format(v);

        const fmtUSD = v =>
          new Intl.NumberFormat('en-US', { style:'currency', currency:'USD', minimumFractionDigits:2, maximumFractionDigits:2 }).format(v);

        const toUSD = (thb) => {
          if (!Number.isFinite(thb)) return null;
          const satang = Math.round(thb * 100);
          const cents  = Math.floor(satang / EXCHANGE);
          return cents / 100;
        };

        function toNum(v){
          if (v === null || v === undefined) return null;
          if (typeof v === 'number') return Number.isFinite(v) ? v : null;
          const s = String(v).trim();
          if (!s) return null;
          const n = parseFloat(s.replace(/[^\d.-]/g, ''));
          return Number.isFinite(n) ? n : null;
        }

        function priceTextOrQuote(p){
          const lang = getLang();
          const quote = (lang === 'English') ? 'Request a quote' : 'ขอใบเสนอราคา';
          const n = toNum(p);
          if (n === null || n <= 0) return quote;
          return (lang === 'English') ? fmtUSD(toUSD(n)) : fmtTHB(n);
        }

        function closeDD(dd){ dd.classList.add('hidden'); dd.innerHTML=''; }
        function openDD(dd){ dd.classList.remove('hidden'); }

        function render(dd, items){
          dd.innerHTML = '';
          if (!items.length){
            dd.innerHTML = `<div class="px-3 py-2 text-sm text-gray-500">ไม่พบผลลัพธ์</div>`;
            openDD(dd); return;
          }
          items.forEach(it => {
            const name  = (it.name || '').trim() || '—';
            const cat   = (it.cat  || '').trim();
            const img   = it.pic   || '';
            const price = priceTextOrQuote(it.price);

            const row = document.createElement('a');
            row.href  = it.url;
            row.className = 'flex gap-3 items-center px-3 py-2 hover:bg-orange-50 transition-colors';
            row.innerHTML = `
              <div class="h-10 w-10 rounded border bg-gray-50 overflow-hidden flex-shrink-0">
                ${img ? `<img src="${img}" alt="" class="w-full h-full object-cover">` : ''}
              </div>
              <div class="min-w-0 flex-1">
                <div class="text-sm text-gray-800 truncate">${name}</div>
                <div class="text-xs text-gray-500 truncate">${cat}</div>
              </div>
              <div class="text-sm font-semibold text-[var(--brand)] ml-2">${price}</div>
            `;
            dd.appendChild(row);
          });
          openDD(dd);
        }

        async function fetchDB(q){
          const url = new URL(SEARCH_URL, window.location.origin);
          url.searchParams.set('q', q);
          const res = await fetch(url.toString(), { headers: { 'Accept': 'application/json' } });
          if (!res.ok) return [];
          const data = await res.json();
          return Array.isArray(data) ? data : [];
        }

        targets.forEach(({input, results})=>{
          let timer=null, last='';
          input.addEventListener('input', ()=>{
            const q = input.value.trim();
            last = q;
            clearTimeout(timer);

            if (q.length < 3){ closeDD(results); return; }

            timer = setTimeout(async ()=>{
              try{
                const items = await fetchDB(q);
                render(results, items);
              }catch(e){
                console.warn('search error:', e);
                closeDD(results);
              }
            }, 220);
          });

          document.addEventListener('click', (e)=>{
            const hit = e.target.closest(`#${results.id}, #${input.id}`);
            if (!hit) closeDD(results);
          });

          window.addEventListener('site_lang_changed', async ()=>{
            if (!results.classList.contains('hidden') && last.length >= 3){
              const items = await fetchDB(last);
              render(results, items);
            }
          });
        });
      })();
      </script>

      <div class="p-2">
        <section class="border rounded-lg mb-2 overflow-hidden">
          <button class="w-full flex items-center justify-between px-4 py-3 text-left font-medium"
                  data-collapse-toggle="#mgrp1" aria-expanded="false">
            <span data-i18n="mega_measure">เครื่องมือวัด</span>
            <i class="bi bi-caret-down"></i>
          </button>
          <ul id="mgrp1" class="hidden px-4 pb-3 text-sm space-y-2">
            <li><a href="http://127.0.0.1:8000/products/category/ClampMeter1" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_1">แคลมป์มิเตอร์</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/Multimeters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_2">มัลติมิเตอร์</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/ElectricalTesters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_3">เครื่องทดสอบไฟฟ้า</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/InsulationTesters" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_4">เครื่องวัดฉนวน</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/Thermography" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_5">กล้องถ่ายภาพความร้อน</a></li>
          </ul>
        </section>

        <section class="border rounded-lg mb-2 overflow-hidden">
          <button class="w-full flex items-center justify-between px-4 py-3 text-left font-medium"
                  data-collapse-toggle="#mgrp2" aria-expanded="false">
            <span data-i18n="mega_process">กระบวนการ/สอบเทียบ</span>
            <i class="bi bi-caret-down"></i>
          </button>
          <ul id="mgrp2" class="hidden px-4 pb-3 text-sm space-y-2">
            <li><a href="http://127.0.0.1:8000/products/category/LoopCalibrators" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p1">เครื่องสอบเทียบลูป</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/CalibrationTools" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p2">เครื่องสอบเทียบความดัน</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/Temperature" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p3">เครื่องสอบเทียบอุณหภูมิ</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/ProcessCalibrators" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_p4">เครื่องสอบเทียบกระบวนการ</a></li>
          </ul>
        </section>

        <section class="border rounded-lg mb-2 overflow-hidden">
          <button class="w-full flex items-center justify-between px-4 py-3 text-left font-medium"
                  data-collapse-toggle="#mgrp3" aria-expanded="false">
            <span data-i18n="mega_accessories">อุปกรณ์เสริม</span>
            <i class="bi bi-caret-down"></i>
          </button>
          <ul id="mgrp3" class="hidden px-4 pb-3 text-sm space-y-2">
            <li><a href="http://127.0.0.1:8000/products/category/TestLeadsProbes" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a1">สายวัดและโพรบ</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/BatteriesChargers" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a2">แบตเตอรี่และชาร์จ</a></li>
            <li><a href="http://127.0.0.1:8000/products/category/ToolCases" class="block hover:text-[var(--brand)] hover:pl-1 transition" data-i18n="cat_left_a3">กล่องเก็บเครื่องมือ</a></li>
          </ul>
        </section>
      </div>
    </aside>
  </div>
</nav>

</body>
</html>
<br>
  <main>
    
    <section class="sr-only" role="region" aria-label="myFlukeTH / Fluke Thailand">
      <h1>myFlukeTH — เครื่องมืออุตสาหกรรม FLUKE (Fluke Thailand)</h1>

      <p>
        กำลังค้นหา <strong>myfluketh</strong>, <strong>myfluke</strong>, <strong>fluketh</strong>, <strong>fluke</strong> หรือ <strong>ฟลุค</strong> อยู่ใช่ไหม?
        ที่นี่คือศูนย์รวมเครื่องมือวัดไฟฟ้า <strong>FLUKE</strong> ครบวงจร — มัลติมิเตอร์, แคลมป์มิเตอร์, เครื่องทดสอบไฟฟ้า,
        เครื่องวัดฉนวน และกล้องถ่ายภาพความร้อน พร้อมบริการคาลิเบรตมาตรฐานสากล
        สอบถาม 066-097-5697 (<strong>คุณผักบุ้ง</strong>) | อีเมล <strong>info@hikaripower.com</strong> | LINE <strong>@hikaridenki</strong>
      </p>

      <nav aria-label="popular brand searches">
        <a href="http://127.0.0.1:8000">myfluketh</a>
        <a href="http://127.0.0.1:8000">myfluke</a>
        <a href="http://127.0.0.1:8000">fluketh</a>
        <a href="http://127.0.0.1:8000">Fluke Thailand</a>
        <a href="http://127.0.0.1:8000">ฟลุค</a>
      </nav>
    </section>

    
        <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"http://127.0.0.1:8000","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"http://127.0.0.1:8000/fluke-marketplace","name":"FLUKE Marketplace"}}]}</script>

    
  </main>

  
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js" defer></script>

    <!-- ===== Hero area ===== -->
    <section class="container-outer mx-auto section-pad mt-3 md:mt-5 grid grid-cols-1 md:grid-cols-12 gap-4">
      <aside class="hidden md:block md:col-span-3 card p-2 left-cat">
        <ul class="text-sm divide-y">
          <li><a href="http://127.0.0.1:8000/products/category/ClampMeter1" class="px-3 py-2" data-i18n="left_c1">แคลมป์มิเตอร์</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/Multimeters"  class="px-3 py-2" data-i18n="left_c2">มัลติมิเตอร์</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/ElectricalTesters"  class="px-3 py-2" data-i18n="left_c3">เครื่องตรวจไฟ/ทดสอบไฟฟ้า</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/Thermography"  class="px-3 py-2" data-i18n="left_c4">กล้องถ่ายภาพความร้อน</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/InsulationTesters"  class="px-3 py-2" data-i18n="left_c5">เครื่องวัดฉนวน</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/PowerQuality"  class="px-3 py-2" data-i18n="left_c6">คุณภาพไฟฟ้า</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/LoopCalibrators"  class="px-3 py-2" data-i18n="left_c7">เครื่องสอบเทียบ</a></li>
          <li><a href="http://127.0.0.1:8000/products/category/Accessories"  class="px-3 py-2" data-i18n="left_c8">อุปกรณ์เสริม</a></li>
        </ul>
      </aside>

      <div class="md:col-span-6">
        <div class="swiper mySwiper swiper-pro card">
          <div class="swiper-wrapper">
            <div class="swiper-slide bg-white flex items-center justify-center">
              <img src="http://127.0.0.1:8000/storage/logo.jpg" alt="hero1" class="max-w-full max-h-full object-contain" loading="eager" decoding="async" />
            </div>
            <div class="swiper-slide bg-white flex items-center justify-center">
              <img src="http://127.0.0.1:8000/storage/logo1.jpg" alt="hero2" class="max-w-full max-h-full object-contain" loading="eager" decoding="async" />
            </div>
            <div class="swiper-slide bg-white flex items-center justify-center">
              <img src="http://127.0.0.1:8000/storage/logo2.jpg" alt="hero3" class="max-w-full max-h-full object-contain" loading="eager" decoding="async" />
            </div>
          </div>
          <div class="swiper-pagination"></div>
        </div>
      </div>

      <aside class="md:col-span-3 promo-col">
        <a href="/SpecialOffers" class="promo-pro group focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--brand)]">
          <div class="promo-icon bg-gradient-to-br from-amber-100 to-yellow-200 relative z-10">
            <i class="bi bi-lightning-charge text-[var(--brand)] text-2xl"></i>
          </div>
          <div class="min-w-0 relative z-10">
            <p class="text-base font-semibold text-gray-900 truncate" data-i18n="promo1_title">ข้อเสนอพิเศษ</p>
            <p class="text-sm text-gray-600 truncate" data-i18n="promo1_sub"> ประหยัดกว่าเดิม</p>
          </div>
          <i class="bi bi-arrow-right-short text-gray-400 text-3xl transition-transform duration-300 group-hover:translate-x-1 relative z-10"></i>
          <span aria-hidden="true" class="pointer-events-none absolute -right-10 -bottom-10 h-28 w-28 rounded-full bg-amber-100/70 z-0"></span>
        </a>

        <a href="/LatestProducts" class="promo-pro group focus:outline-none focus-visible:ring-2 focus-visible:ring-orange-500">
          <div class="promo-icon bg-gradient-to-br from-orange-100 to-orange-200 relative z-10">
            <i class="bi bi-stars text-orange-500 text-2xl"></i>
          </div>
          <div class="min-w-0 relative z-10">
            <p class="text-base font-semibold text-gray-900 truncate" data-i18n="promo2_title">สินค้าใหม่ล่าสุด</p>
            <p class="text-sm text-gray-600 truncate" data-i18n="promo2_sub">อัปเดตทุกสัปดาห์</p>
          </div>
          <i class="bi bi-arrow-right-short text-gray-400 text-3xl transition-transform duration-300 group-hover:translate-x-1 relative z-10"></i>
          <span aria-hidden="true" class="pointer-events-none absolute -left-10 -bottom-10 h-28 w-28 rounded-full bg-orange-100/70 z-0"></span>
        </a>
      </aside>
    </section>

    <br>

    <!-- ===== Flash Deals ===== -->
    <section class="container-outer mx-auto section-pad mt-6">
      <div class="card p-3 md:p-4">
        <div class="flex items-center justify-between mb-3">
          <h3 class="text-lg md:text-xl font-bold" data-i18n="flash_title">Flash Deals</h3>
          <a href="http://127.0.0.1:8000/products">ดูทั้งหมด</a>
        </div>

        <div id="flashGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-3"></div>
      </div>
    </section>

    <template id="dealTileTemplate">
      <a class="block hover:shadow transition-fast">
        <div class="border rounded-lg overflow-hidden bg-white">
          <div class="aspect-square bg-gray-50">
            <img class="deal-img block w-full h-full object-cover object-center" alt="">
          </div>
        </div>
        <div class="p-2">
          <div class="flex items-center gap-1 text-xs text-gray-700">
            <span class="flex-shrink-0">Model:</span>
            <span class="deal-model text-gray-800 font-semibold truncate block">—</span>
          </div>
          <div class="flex items-center gap-1 text-sm text-gray-700 mt-1 overflow-hidden">
            <span class="text-[10px] text-gray-600 flex-shrink-0">Detail:</span>
            <span class="deal-name text-sm text-gray-700 font-normal truncate block">—</span>
          </div>
          <p class="deal-price text-[var(--brand)] font-semibold mt-1">฿—</p>
        </div>
      </a>
    </template>

    <br>

    <!-- ===== หมวดหมู่สินค้า ===== -->
    <section class="container-outer mx-auto section-pad mt-10">
      <div class="max-w-6xl mx-auto">
        <h3 class="text-3xl font-bold mb-6 text-center text-gray-700" data-i18n="cat_title">หมวดหมู่สินค้า</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
          <a href="http://127.0.0.1:8000/products/category/ClampMeter1" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/clamp-meters.jpg" alt="Clamp Meter" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_1">แคลมป์มิเตอร์</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/ElectricalTesters" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/electrical-testers.jpg" alt="Electrical Testers" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_2">เครื่องทดสอบไฟฟ้า</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/GroundResistance" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/ground-resistance.jpg" alt="Ground Resistance" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_3">เครื่องทดสอบสายดิน</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/InsulationTesters" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/insulation-testers.jpg" alt="Insulation Testers" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_4">เครื่องวัดฉนวน</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/Multimeters" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/multimeters.jpg" alt="Multimeters" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_5">มัลติมิเตอร์</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/PowerQuality" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/power-quality.jpg" alt="Power Quality" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_6">คุณภาพไฟฟ้า</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/PreventativeMaintenance" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/preventative-maintenance.jpg" alt="Preventative Maintenance" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_7">การบำรุงรักษา</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/ProcessTools" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/process-tools.jpg" alt="Process Tools" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_8">เทอร์โมกราฟี</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/ScopeMeters" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/scope-meters.jpg" alt="Scope Meters" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_9">เครื่องวัดสโคป</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/Temperature" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/temperature.jpg" alt="Temperature Tools" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_10">เครื่องมือวัดอุณหภูมิ</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/Thermography" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/thermography.jpg" alt="Thermography" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_11">กล้องถ่ายภาพความร้อน</p></div>
            </div>
          </a>
          <a href="http://127.0.0.1:8000/products/category/MiscTools" class="block lift">
            <div class="card overflow-hidden cat-card">
              <img src="http://127.0.0.1:8000/storage/misc-tools.jpg" alt="Misc Tools" class="w-full h-40 md:h-44 object-cover">
              <div class="cat-caption"><p data-i18n="cat_g_12">เครื่องมืออื่น ๆ</p></div>
            </div>
          </a>
        </div>
      </div>
    </section>
  </main>

  
  <!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Footer • myFlukeTH</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    :root{
      --brand:#ff6a00;
      --ink:#111827;
      --card:#ffffff;
      --bg:#0b1220;          /* พื้นหลังฟุตเตอร์ */
      --radius:12px;
      --com:#fb923c;         /* สีลิงก์/ปุ่มเปิดแผนที่ */
    }

    html, body{ height:100%; margin:0; overscroll-behavior:none; overflow-x:hidden; }
    body{
      font-family:'Prompt', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#f3f4f6; color:var(--ink);
    }



    footer.compact{ font-size:0.9rem; }
    footer.compact .title{ font-size:clamp(1rem, 3.2vw, 1.35rem); line-height:1.15; }
    footer.compact .lead{ font-size:clamp(12px, 2.9vw, 14px); line-height:1.5; }
    footer.compact .contact-grid{ gap:8px; }
    footer.compact .contact-card{ padding:.45rem .6rem; }
    footer.compact .contact-ico{ width:30px; height:30px; }
    footer.compact .contact-ico i{ font-size:12px; }
    footer.compact .round{ border-radius:12px; }
    footer.compact .round-lg{ border-radius:12px; }
    footer.compact .thin{ border:1px solid rgba(255,255,255,.12); }

    /* มือถือ: การ์ดเรียง 1 คอลัมน์, แผนที่สูงตามจอ */
    .map-h{ height:clamp(180px, 42vw, 260px); }
    @media (min-width:480px){ .map-h{ height:clamp(200px, 38vw, 260px); } }
    @media (min-width:768px){
      .map-h{ height:240px; }
      footer.compact .contact-grid{ grid-template-columns:repeat(2,minmax(0,1fr)); }
    }

    /* Background glow */
    footer .halo-a{ width:260px; height:260px; opacity:.18; }
    footer .halo-b{ width:280px; height:280px; opacity:.12; }

    /* Popup สีลิงก์ / ปุ่มปิด */
    .leaflet-popup-content a{ color:var(--com) !important; font-weight:600; }
    .leaflet-popup-content a:hover{ text-decoration:underline; }
    .leaflet-popup-close-button{ color:var(--com); }
    .leaflet-popup-close-button:hover{ color:#fff; background:var(--com); border-radius:8px; }

    /* ซ่อนซูมคอนโทรล */
    .leaflet-control-zoom{ display:none !important; }

    /* ป้องกันแผนที่แย่งสกอลล์บนมือถือ (แตะเพื่อเปิด interaction) */
    .map-wrap{ position:relative; }
    .map-wrap.mobile-guard:not(.active) #hk-map{ pointer-events:none; }
    .map-overlay{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(11,18,32,.02), rgba(11,18,32,.35));
      color:#fff; text-align:center; padding:10px; font-size:12px; line-height:1.4;
      backdrop-filter: blur(2px);
    }
    .map-overlay .pill{
      background:rgba(255,255,255,.92); color:#0b1220;
      padding:6px 10px; border-radius:999px; font-weight:600;
      display:inline-flex; align-items:center; gap:6px;
      box-shadow:0 6px 18px rgba(0,0,0,.18);
    }
    .map-overlay .pill i{ font-size:14px; }

    /* ปุ่มเปิด Google Maps มุมขวาบน (ย่ออัตโนมัติ) */
    .map-actions{ position:absolute; top:8px; right:8px; z-index:500; display:flex; gap:6px; }
    .btn-openmaps{
      appearance:none; border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.14); color:#fff;
      padding:4px 8px; border-radius:999px; font-size:11px; font-weight:600;
      display:inline-flex; align-items:center; gap:6px;
      backdrop-filter: blur(6px); line-height:1;
    }
    .btn-openmaps:hover{ background:rgba(255,255,255,.22); }
    .btn-openmaps .dot{ width:8px; height:8px; border-radius:999px; background:var(--com); }
    @media (max-width:360px){
      .btn-openmaps .label{ display:none; }
      .btn-openmaps{ padding:4px; }
    }

    /* ป้องกันข้อความยาวล้น (เช่นอีเมล) */
    .break-any{ overflow-wrap:anywhere; word-break:break-word; }
  </style>
</head>

<body>
  <br><br><br>
  <footer class="compact relative overflow-hidden text-white" style="background:var(--bg);">
    <!-- Background glow -->
    <div aria-hidden="true" class="pointer-events-none absolute inset-0">
      <div class="halo-a absolute -top-16 -left-16 rounded-full blur-3xl"
           style="background: radial-gradient(closest-side, #ff6a00, transparent 70%);"></div>
      <div class="halo-b absolute -bottom-20 -right-10 rounded-full blur-3xl"
           style="background: radial-gradient(closest-side, #22c55e, transparent 70%);"></div>
    </div>

    <div class="container-outer section-pad mx-auto py-5 md:py-7 relative">
      <div class="grid md:grid-cols-12 gap-3 md:gap-6 items-start">
        <!-- Left -->
        <div class="md:col-span-7">
          <h3 class="title font-extrabold tracking-tight">
            myFlukeTH<span class="text-orange-400">.com</span>
          </h3>

          <p class="lead mt-2 text-gray-300">
            Measurement and test instrument solutions from
            <span class="text-orange-300 font-semibold">Fluke</span>
            for industrial and engineering applications — multimeters, electrical safety testers,
            thermal imaging cameras, and calibration instruments — all backed by support services
            that meet international standards.
          </p>
          
          <!-- Contacts -->
          <div class="contact-grid mt-3 grid grid-cols-1">
            <!-- Tel -->
            <a href="tel:+66660975697"
               class="group round bg-gradient-to-br from-white/15 to-white/5 p-[1px] transition">
              <div class="contact-card round bg-white/5 backdrop-blur-sm thin flex items-center gap-2.5">
                <span class="contact-ico round thin flex items-center justify-center">
                  <i class="bi bi-telephone text-white/80"></i>
                </span>
                <div class="leading-5">
                  <div class="font-semibold tracking-tight text-[.95rem]">066-097-5697</div>
                  <div class="text-[11px] text-gray-400">(คุณ ผักบุ้ง)</div>
                </div>
              </div>
            </a>

<!-- Email: เปิด Gmail ด้วย To + Subject เท่านั้น (ไม่มี body) -->
<a id="emailBtn"
   href="mailto:Info@hikaripower.com"
   class="group round bg-gradient-to-br from-white/15 to-white/5 p-[1px] transition"
   data-to="Info@hikaripower.com"
   data-subject="สอบถามสินค้าMyFlukeTH:"
   onclick="return openEmailSimple(event);"
   rel="nofollow noopener">
  <div class="contact-card round bg-white/5 backdrop-blur-sm thin flex items-center gap-2.5 px-3 py-2.5">
    <span class="contact-ico round thin flex items-center justify-center w-8 h-8 bg-white/10">
      <i class="bi bi-envelope text-white/80"></i>
    </span>
    <div class="leading-5 break-any">
      <div class="font-semibold tracking-tight text-[.95rem]">Info@hikaripower.com</div>
      <div class="text-[11px] text-gray-400">สอบถามสินค้าMyFlukeTH:</div>
    </div>
  </div>
</a>

<script>
function openEmailSimple(evt){
  if (evt && evt.preventDefault) evt.preventDefault();

  const el = evt.currentTarget;
  const to = (el.dataset.to || 'Info@hikaripower.com').trim();
  const subject = (el.dataset.subject || 'สอบถามสินค้าMyFlukeTH:').trim();

  // เปิด Gmail (ไม่มี body) และ fallback เป็น mailto
  const gmail = 'https://mail.google.com/mail/?view=cm&fs=1'
              + '&to=' + encodeURIComponent(to)
              + '&su=' + encodeURIComponent(subject);

  const mailto = 'mailto:' + encodeURIComponent(to)
              + '?subject=' + encodeURIComponent(subject); // ไม่ใส่ body

  const win = window.open(gmail, '_blank', 'noopener,noreferrer');
  if (!win) window.location.href = mailto;
  return false;
}
</script>


            <!-- LINE (เปิดแอป → ถ้าไม่มีแอปค่อยไปหน้าเว็บ Add Friend) -->
            <a id="lineBtn"
               href="https://line.me/R/ti/p/%40543ubjtx"
               target="_blank" rel="noopener"
               class="group round bg-gradient-to-br from-emerald-400/25 to-emerald-400/10 p-[1px] transition">
              <div class="contact-card round bg-white/5 backdrop-blur-sm thin flex items-center gap-2.5">
                <span class="contact-ico round thin flex items-center justify-center border-emerald-400/40">
                  <img src="https://cdn.simpleicons.org/line/06C755" alt="LINE" class="w-4 h-4" />
                </span>
                <div class="leading-5">
                  <div class="font-semibold tracking-tight text-[.95rem]">LINE : @hikaridenki</div>
                </div>
              </div>
            </a>
          </div>
        </div>

        <!-- Right (Map) -->
        <div class="md:col-span-5">
          <div class="relative round-lg overflow-hidden">
            <div class="absolute inset-0 round-lg bg-gradient-to-br from-white/15 to-white/10 opacity-25 pointer-events-none"></div>

            <div class="relative round-lg thin bg-white/5 backdrop-blur-sm shadow-xl">
              <!-- ปุ่มเปิด Google Maps -->
              <div class="map-actions">
                <button class="btn-openmaps" id="openMapsBtn" type="button" aria-label="Open in Google Maps">
                  <span class="dot" aria-hidden="true"></span>
                  <span class="label" style="color:#0b1220"> Google Maps</span>
                </button>
              </div>

              <!-- กล่องแผนที่ + overlay -->
              <div class="map-wrap mobile-guard md:mobile-guard:!hidden" id="mapWrap">
                <div id="hk-map" class="map-h" role="img" aria-label="แผนที่ตำแหน่ง บริษัท ฮิคาริ เดงกิ จำกัด"></div>

                <!-- overlay เฉพาะมือถือ -->
                <div class="map-overlay md:hidden" id="mapOverlay">
                  <span class="pill"><i class="bi bi-hand-index-thumb"></i> แตะเพื่อโต้ตอบแผนที่</span>
                </div>
              </div>
            </div>
          </div>
        </div> <!-- /Right -->
      </div>

      <!-- Footer bottom -->
      <div class="mt-4 border-t border-white/10 pt-3 text-center text-[10px] text-gray-400">
        © 2025 myFlukeTH.com — บริษัท ฮิคาริ เดงกิ จำกัด. All rights reserved.
      </div>
    </div>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    (function () {
      const lat = 13.717683, lng = 100.4732644;

      // หมุดสีแดง (SVG)
      const redSvg = `
<svg xmlns="http://www.w3.org/2000/svg" width="25" height="41" viewBox="0 0 25 41">
  <defs>
    <linearGradient id="g" x1="50%" x2="50%" y1="0%" y2="100%">
      <stop stop-color="#ff4d4f" offset="0%"/>
      <stop stop-color="#d90429" offset="100%"/>
    </linearGradient>
  </defs>
  <path d="M12.5,0 C5.6,0 0,5.6 0,12.5 c0,9.7 11.6,19.8 12.1,20.3 c0.2,0.2 0.6,0.2 0.8,0 c0.5-0.5 12.1-10.6 12.1-20.3 C25,5.6 19.4,0 12.5,0z"
        fill="url(#g)" stroke="#a10014" stroke-width="1"/>
  <circle cx="12.5" cy="12.5" r="4.2" fill="#fff"/>
</svg>`.trim();

      const redIcon = L.icon({
        iconUrl: 'data:image/svg+xml;utf8,' + encodeURIComponent(redSvg),
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        shadowSize: [41, 41],
        shadowAnchor: [13, 41],
      });

      // ไม่มีปุ่มซูม
      const map = L.map('hk-map', { zoomControl:false }).setView([lat, lng], 17);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap'
      }).addTo(map);

      const marker = L.marker([lat, lng], { icon: redIcon }).addTo(map);
      marker.bindPopup(`
        <strong>บริษัท ฮิคาริ เดงกิ จำกัด</strong><br>
        <a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank" rel="noopener">เปิดใน Google Maps</a>
      `);

      if (window.matchMedia('(min-width: 768px)').matches) { marker.openPopup(); }

      // ===== มือถือ: overlay กันแผนที่แย่งสกอลล์ =====
      const mapWrap = document.getElementById('mapWrap');
      const overlay = document.getElementById('mapOverlay');
      const isMobile = () => window.matchMedia('(max-width: 767.98px)').matches;

      function enableMapInteraction() {
        mapWrap.classList.add('active');     // เปิด pointer-events ให้แผนที่
        overlay.style.display = 'none';
      }
      function disableMapInteraction() {
        mapWrap.classList.remove('active');  // ปิด pointer-events (กลับมาสกอลล์หน้าเว็บ)
        if (isMobile()) overlay.style.display = '';
      }

      if (isMobile()) {
        disableMapInteraction();
        overlay.addEventListener('click', enableMapInteraction, { passive: true });

        let idleTimer;
        map.on('dragstart zoomstart touchstart', () => { clearTimeout(idleTimer); });
        map.on('dragend zoomend touchend', () => {
          clearTimeout(idleTimer);
          idleTimer = setTimeout(disableMapInteraction, 8000);
        });

        document.addEventListener('click', (e) => {
          if (!mapWrap.contains(e.target)) disableMapInteraction();
        });
      }

      // ปุ่มเปิดใน Google Maps (พยายามเปิดแอปก่อน)
      document.getElementById('openMapsBtn').addEventListener('click', function(){
        const deep = `comgooglemaps://?q=${lat},${lng}&zoom=17`;
        const web  = `https://www.google.com/maps?q=${lat},${lng}`;
        const start = Date.now();
        window.location.href = deep;
        setTimeout(function () { if (Date.now() - start < 1200) window.open(web, '_blank', 'noopener'); }, 800);
      });
    })();
  </script>

  <!-- LINE deep link: เปิดแอปก่อน → ถ้าไม่สำเร็จค่อยเปิดหน้า Add Friend บนเว็บ -->
  <script>
    (function () {
      const lineBtn = document.getElementById('lineBtn');
      if (!lineBtn) return;

      lineBtn.addEventListener('click', function (e) {
        e.preventDefault();
        const deep = 'line://ti/p/@543ubjtx';                 // เปิดแอป LINE ไปหน้ากด Add Friend
        const web  = 'https://line.me/R/ti/p/%40543ubjtx';    // fallback หน้า Add Friend บนเว็บ (%40 = @)

        const start = Date.now();
        // พยายามเปิดแอปก่อน
        window.location.href = deep;

        // ถ้าไม่สำเร็จภายใน ~0.7–1.2s ให้เปิดหน้าเว็บแทน
        setTimeout(function () {
          if (Date.now() - start < 1200) {
            window.open(web, '_blank', 'noopener');
          }
        }, 700);
      }, { passive: false });
    })();
  </script>
</body>
</html>

  
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

  <script>
    // Swiper
    document.addEventListener('DOMContentLoaded', function(){
      if (typeof Swiper !== 'undefined' && document.querySelector('.mySwiper')) {
        new Swiper('.mySwiper', {
          loop:true,
          pagination:{ el:'.swiper-pagination', clickable:true },
          autoplay:{ delay:3500, disableOnInteraction:false },
          effect:'fade',
          fadeEffect:{ crossFade:true },
          speed:700
        });
      }
    });
  </script>

  <!-- ===== I18N DICTIONARY & applyI18n ===== -->
  <script>
    const I18N = {
      'ไทย': {
        brand_name:'FLUKE', top_buyer_central:'Buyer Central', top_help:'Help', top_get_app:'Get the App', top_choose_lang:'เลือกภาษา',
        top_login:'เข้าสู่ระบบ', top_join_free:'สมัครสมาชิกฟรี', nav_all_categories:'หมวดหมู่ทั้งหมด',
        mega_measure:'เครื่องมือวัด', mega_process:'กระบวนการ/สอบเทียบ', mega_accessories:'อุปกรณ์เสริม',
        cat_left_1:'แคลมป์มิเตอร์', cat_left_2:'มัลติมิเตอร์', cat_left_3:'เครื่องทดสอบไฟฟ้า', cat_left_4:'เครื่องวัดฉนวน', cat_left_5:'กล้องถ่ายภาพความร้อน',
        cat_left_p1:'เครื่องสอบเทียบลูป', cat_left_p2:'เครื่องสอบเทียบความดัน', cat_left_p3:'เครื่องสอบเทียบอุณหภูมิ', cat_left_p4:'เครื่องสอบเทียบกระบวนการ',
        cat_left_a1:'สายวัดและโพรบ', cat_left_a2:'แบตเตอรี่และชาร์จ', cat_left_a3:'กล่องเก็บเครื่องมือ', cat_left_a4:'อะไหล่สำรอง',
        search_placeholder:'คุณต้องการให้เราช่วยค้นหาอะไร', search_btn:'ค้นหา',
        left_c1:'แคลมป์มิเตอร์', left_c2:'มัลติมิเตอร์', left_c3:'เครื่องตรวจไฟ/ทดสอบไฟฟ้า', left_c4:'กล้องถ่ายภาพความร้อน',
        left_c5:'เครื่องวัดฉนวน', left_c6:'คุณภาพไฟฟ้า', left_c7:'เครื่องสอบเทียบ', left_c8:'อุปกรณ์เสริม',
        promo1_title:'ข้อเสนอพิเศษ', promo1_sub:'ประหยัดกว่าเดิม',
        promo2_title:'สินค้าใหม่ล่าสุด', promo2_sub:'อัปเดตทุกสัปดาห์',
        flash_title:'Flash Deals', flash_view_all:'ดูทั้งหมด', deal_name:'ชื่อสินค้า',
        cat_title:'หมวดหมู่สินค้า',
        cat_g_1:'แคลมป์มิเตอร์', cat_g_2:'เครื่องทดสอบไฟฟ้า', cat_g_3:'เครื่องทดสอบสายดิน', cat_g_4:'เครื่องวัดฉนวน',
        cat_g_5:'มัลติมิเตอร์', cat_g_6:'คุณภาพไฟฟ้า', cat_g_7:'การบำรุงรักษา', cat_g_8:'เทอร์โมกราฟี',
        cat_g_9:'เครื่องวัดสโคป', cat_g_10:'เครื่องมือวัดอุณหภูมิ', cat_g_11:'กล้องถ่ายภาพความร้อน', cat_g_12:'เครื่องมืออื่น ๆ',
        footer_contact:'ติดต่อเรา', footer_branch:'สาขาของเรา', footer_social:'Facebook / YouTube',
        footer_service:'บริการของเรา', footer_calib:'ห้องปฏิบัติการสอบเทียบ', footer_promo:'สินค้าโปรโมชั่น',
        footer_warranty:'การรับประกันสินค้า', footer_repair:'บริการซ่อมแซม',
        footer_info:'ข้อมูล', footer_ship:'ค่าขนส่ง', footer_terms:'ข้อกำหนด / ความเป็นส่วนตัว',
        footer_order:'วิธีการสั่งซื้อ', footer_faq:'คำถามที่พบบ่อย',
        footer_payment:'วิธีชำระเงิน', footer_cards:'Visa / Mastercard / โอนเงิน',
        footer_transfer:'รองรับการโอนผ่านบัญชีบริษัท', footer_cod:'เงินสดปลายทาง',
        copyright:'© 2024 FLUKE. สงวนลิขสิทธิ์ทั้งหมด', top_user:'ผู้ใช้', top_logout:'ออกจากระบบ', label_profile:'โปรไฟล์'
      },
      'English': {
        brand_name:'FLUKE', top_buyer_central:'Buyer Central', top_help:'Help', top_get_app:'Get the App', top_choose_lang:'Choose language',
        top_login:'Login', top_join_free:'Join Free', nav_all_categories:'All categories',
        mega_measure:'Measuring Tools', mega_process:'Process / Calibration', mega_accessories:'Accessories',
        cat_left_1:'Clamp Meters', cat_left_2:'Multimeters', cat_left_3:'Electrical Testers', cat_left_4:'Insulation Testers', cat_left_5:'Thermal Cameras',
        cat_left_p1:'Loop Calibrators', cat_left_p2:'Pressure Calibrators', cat_left_p3:'Temperature Calibrators', cat_left_p4:'Process Calibrators',
        cat_left_a1:'Test Leads & Probes', cat_left_a2:'Batteries & Chargers', cat_left_a3:'Tool Cases', cat_left_a4:'Spare Parts',
        search_placeholder:'What can we help you find?', search_btn:'Search',
        left_c1:'Clamp Meters', left_c2:'Multimeters', left_c3:'Electrical Testers', left_c4:'Thermal Cameras',
        left_c5:'Insulation Testers', left_c6:'Power Quality', left_c7:'Loop Calibrators', left_c8:'Accessories',
        promo1_title:'Special Offers', promo1_sub:'More worthwhile',
        promo2_title:'Latest Products', promo2_sub:'Updated weekly',
        flash_title:'Flash Deals', flash_view_all:'View all', deal_name:'Product name',
        cat_title:'Categories',
        cat_g_1:'Clamp Meters', cat_g_2:'Electrical Testers', cat_g_3:'Ground Resistance', cat_g_4:'Insulation Testers',
        cat_g_5:'Multimeters', cat_g_6:'Power Quality', cat_g_7:'Preventative Maintenance', cat_g_8:'Thermography',
        cat_g_9:'Scope Meters', cat_g_10:'Temperature Tools', cat_g_11:'Thermal Imaging', cat_g_12:'Misc Tools',
        footer_contact:'Contact Us', footer_branch:'Our Branches', footer_social:'Facebook / YouTube',
        footer_service:'Our Services', footer_calib:'Calibration Laboratory', footer_promo:'Promotion Products',
        footer_warranty:'Warranty', footer_repair:'Repair Service',
        footer_info:'Information', footer_ship:'Shipping Cost', footer_terms:'Terms / Privacy Policy',
        footer_order:'How to Order', footer_faq:'FAQ',
        footer_payment:'Payment Methods', footer_cards:'Visa / Mastercard / Bank Transfer',
        footer_transfer:'Support company account transfer', footer_cod:'Cash on Delivery',
        copyright:'© 2024 FLUKE. All rights reserved', top_user:'user', top_logout:'Sign out', label_profile:'Profile'
      }
    };

    function applyI18n(lang){
      const dict = I18N[lang] || I18N['ไทย'];
      document.documentElement.lang = (lang === 'ไทย') ? 'th' : 'en';
      document.title = (lang === 'ไทย') ? 'เครื่องมืออุตสาหกรรม FLUKE' : 'FLUKE Industrial Tools';
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        const val = dict[key];
        if(val == null) return;
        const attr = el.getAttribute('data-i18n-attr');
        if(attr){ el.setAttribute(attr, val); } else { el.textContent = val; }
      });
      const label = document.getElementById('currentLangLabel');
      if(label) label.textContent = (lang === 'ไทย') ? 'ไทย' : 'English';
      localStorage.setItem('preferredLanguage', lang);
      localStorage.setItem('site_lang', lang);
      window.dispatchEvent(new CustomEvent('site_lang_changed', { detail:{ lang } }));
    }

    document.addEventListener('DOMContentLoaded', () => {
      const langDropdown = document.getElementById('langDropdown');
      const currentLangBtn = document.getElementById('currentLangBtn');

      if (currentLangBtn && langDropdown){
        currentLangBtn.addEventListener('click', (e)=>{
          e.stopPropagation();
          langDropdown.classList.toggle('hidden');
        });
        document.addEventListener('click', (e)=>{
          const hit = e.target.closest('#langDropdown, #currentLangBtn');
          if(!hit){ langDropdown.classList.add('hidden'); }
        });
      }

      document.querySelectorAll('.lang-item').forEach(item=>{
        item.addEventListener('click', ()=>{
          const lang = item.getAttribute('data-lang') || 'ไทย';
          applyI18n(lang);
          if (langDropdown) langDropdown.classList.add('hidden');
        });
      });

      const saved = localStorage.getItem('preferredLanguage') || 'ไทย';
      localStorage.setItem('site_lang', saved);
      applyI18n(saved);
    });
  </script>

  <!-- ===== Flash Deals / Marquee (ตามเดิม) ===== -->
  <script>
  (function () {
    const grid = document.getElementById('flashGrid');
    const tpl  = document.getElementById('dealTileTemplate');
    const CACHE_KEY = 'flashDealsCacheV1';
    const CACHE_TTL_MIN = 360;
    const MAX_ITEMS = 100;
    const EXCHANGE = 38;

    if (!grid || !tpl) return;

    ['grid','grid-cols-2','sm:grid-cols-3','md:grid-cols-6'].forEach(c => grid.classList.remove(c));
    grid.classList.add('relative','overflow-hidden','w-full');

    const track = document.createElement('div');
    track.id = 'flashTrack';
    track.className = 'flex items-stretch gap-3 will-change-transform';
    grid.innerHTML = '';
    grid.appendChild(track);

    window.allItems = [];

    const getLang = () => localStorage.getItem('site_lang') || localStorage.getItem('preferredLanguage') || 'ไทย';
    const fmtTHB = v => new Intl.NumberFormat('th-TH', { style:'currency', currency:'THB', minimumFractionDigits:0, maximumFractionDigits:2 }).format(v);
    const fmtUSD = v => new Intl.NumberFormat('en-US', { style:'currency', currency:'USD', minimumFractionDigits:0, maximumFractionDigits:2 }).format(v);

    const I18NX = { th: { quote: 'ขอใบเสนอราคา' }, en: { quote: 'Request a quote' } };
    const normalizeLang = (s) => {
      s = (s || '').toLowerCase();
      if (['ไทย','thai','th','th-th'].includes(s)) return 'th';
      if (['english','en','en-us','en-gb'].includes(s)) return 'en';
      return 'th';
    };
    const t = (key) => I18NX[normalizeLang(getLang())]?.[key] ?? I18NX.en[key] ?? key;

    const toUSD = (thb) => {
      if (!Number.isFinite(thb) || thb <= 0) return null;
      const satang = Math.round(thb * 100);
      const cents  = Math.ceil(satang / EXCHANGE);
      return cents / 100;
    };

    function renderPriceText(price){
      if (price == null || !Number.isFinite(price) || price <= 0) return t('quote');
      return (normalizeLang(getLang()) === 'en') ? fmtUSD(toUSD(price)) : fmtTHB(price);
    }

    function parseTHB(raw){
      if (raw == null) return null;
      const s = String(raw).replace(/[^\d.]/g,'');
      if (!s) return null;
      const n = parseFloat(s);
      return Number.isFinite(n) ? n : null;
    }

    const addQuery = (u, q) => {
      try{
        const url = new URL(u, location.origin);
        Object.entries(q || {}).forEach(([k,v]) => url.searchParams.set(k, v));
        return url.toString();
      }catch(_){
        const join = u.includes('?') ? '&' : '?';
        const tail = Object.entries(q||{}).map(([k,v]) => k+'='+encodeURIComponent(v)).join('&');
        return u + join + tail;
      }
    };

    function createCard(item){
      if (!item) return document.createDocumentFragment();

      const node     = tpl.content.cloneNode(true);
      const a        = node.querySelector('a');
      const img      = node.querySelector('img.deal-img');
      const modelEl  = node.querySelector('.deal-model');
      const nameEl   = node.querySelector('.deal-name');
      const priceEl  = node.querySelector('.deal-price');

      a.classList.add('w-32','md:w-36','shrink-0');

      const nameTxt  = (item?.name ?? '').toString().trim();
      const modelTxt = (item?.model ?? item?.num_model ?? '').toString().trim();
      const showLine1 = modelTxt || nameTxt || '—';
      const showLine2 = nameTxt || '';

      const valTHB = (typeof parseTHB === 'function') ? parseTHB(item?.webpriceTHB) : item?.webpriceTHB;

      if (item?.iditem){
        a.href = '/product/' + encodeURIComponent(item.iditem);
      }
      a.title = (modelTxt ? modelTxt + ' — ' : '') + (nameTxt || '—');
      a.dataset.iditem = item?.iditem || '';
      a.dataset.model  = modelTxt;
      a.dataset.name   = nameTxt;

      if (img){
        let pic = item?.pic || item?.image || item?.img || '';
        if (pic){
          pic = addQuery(pic, { m: (modelTxt || '').slice(0, 20), n: (nameTxt  || '').slice(0, 20) });
          img.src = pic;
          img.alt = a.title;
          img.loading = 'lazy';
          img.decoding = 'async';
          img.referrerPolicy = 'no-referrer';
        } else {
          img.remove();
        }
      }

      if (modelEl){
        modelEl.textContent = showLine1;
        modelEl.classList.add('text-[11px]','md:text-[12px]','leading-tight');
      }

      if (nameEl){
        if (showLine2){ nameEl.textContent = showLine2; } else { nameEl.remove(); }
        nameEl.classList.add('text-[8px]','md:text-[10px]','leading-tight');
      }

      if (priceEl){
        try {
          priceEl.textContent = (typeof renderPriceText === 'function')
            ? renderPriceText(valTHB)
            : (valTHB != null ? String(valTHB) : '฿—');
        } catch(_){
          priceEl.textContent = '฿—';
        }
        priceEl.classList.add('text-[12px]','md:text-[13px]','leading-tight','font-medium');
      }

      return node;
    }

    let rafId=null, paused=false, offsetX=0, pxPerSec=50;
    let cycleWidth=0, lastTs=0;

    function measureCycle(){
      const track = document.getElementById('flashTrack');
      cycleWidth = track ? Math.floor(track.scrollWidth / 2) || 0 : 0;
    }

    function step(ts){
      const track = document.getElementById('flashTrack');
      if (!track) return;
      if (!lastTs) lastTs = ts;
      const dt = (ts - lastTs) / 1000;
      lastTs = ts;

      if (!paused && pxPerSec > 0 && cycleWidth > 0){
        offsetX -= pxPerSec * dt;
        if (offsetX <= -cycleWidth){
          offsetX += cycleWidth;
        }
        track.style.transform = `translate3d(${offsetX}px,0,0)`;
      }
      rafId = requestAnimationFrame(step);
    }

    function startMarquee(){
      if (rafId) cancelAnimationFrame(rafId);
      measureCycle();
      offsetX = 0; lastTs = 0;
      rafId = requestAnimationFrame(step);
    }

    function renderAll(items){
      const track = document.getElementById('flashTrack');
      if (!track) return;
      track.innerHTML = '';
      const base = items.concat(items);
      base.forEach(it => track.appendChild(createCard(it)));

      const minWidth = grid.clientWidth * 2;
      while (track.scrollWidth < minWidth) {
        base.forEach(it => track.appendChild(createCard(it)));
        if (!track.childElementCount) break;
      }

      startMarquee();

      track.querySelectorAll('img').forEach(img=>{
        if (!img.complete){
          img.addEventListener('load', ()=>{ measureCycle(); }, { once:true });
          img.addEventListener('error', ()=>{ measureCycle(); }, { once:true });
        }
      });
    }

    function shuffleAndPick(arr, max){
      const copy = arr.slice();
      for (let i = copy.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy.slice(0, max);
    }

    function readCache(){
      try{
        const raw = localStorage.getItem(CACHE_KEY);
        if(!raw) return null;
        const obj = JSON.parse(raw);
        if(!obj || !Array.isArray(obj.items)) return null;
        if (obj.ts && (Date.now() - obj.ts) > CACHE_TTL_MIN*60*1000) return null;
        return obj.items;
      }catch{ return null; }
    }
    function writeCache(items){
      try{ localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: Date.now(), items })); }catch{}
    }

    function loadDeals(){
      let pool = Array.isArray(window.FLASH_DEALS)
        ? window.FLASH_DEALS.filter(x => x && x.pic && parseTHB(x.webpriceTHB) != null)
        : [];

      if (!pool.length){
        const cached = readCache();
        if (cached && cached.length) pool = cached;
      }

      if (pool.length){
        window.allItems = shuffleAndPick(pool, MAX_ITEMS);
        writeCache(pool);
        renderAll(window.allItems);
      } else {
        const track = document.getElementById('flashTrack');
        if (track) { track.innerHTML = '<div class="p-3 text-sm text-gray-500">No deals</div>'; }
        startMarquee();
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadDeals);
    } else {
      loadDeals();
    }

    function rerenderCurrency(){
      if (window.allItems && window.allItems.length){
        renderAll(window.allItems);
      }
    }
    grid.addEventListener('mouseenter', ()=> paused=true);
    grid.addEventListener('mouseleave', ()=> paused=false);
    document.addEventListener('visibilitychange', ()=>{ paused = document.hidden; });

    let resizeTimer=null;
    window.addEventListener('resize', ()=>{
      clearTimeout(resizeTimer);
      resizeTimer=setTimeout(()=>{
        const wasPaused = paused;
        paused = true;
        const prevCycle = cycleWidth;
        measureCycle();
        if (prevCycle && cycleWidth) {
          offsetX = ((offsetX % cycleWidth) + cycleWidth) % cycleWidth * -1;
        }
        paused = wasPaused;
      },150);
    });

    window.addEventListener('storage', (e)=>{
      if (e.key === 'site_lang' || e.key === 'preferredLanguage'){
        rerenderCurrency();
      }
    });
    window.addEventListener('site_lang_changed', rerenderCurrency);
    window.rerenderCurrency = rerenderCurrency;
  })();
  </script>

  <!-- ===== Search dropdown, etc. ===== -->
  <script>
    (function(){
      const EXCHANGE = 38;
      const inputs = [
        { el: document.getElementById('globalSearch'), results: document.getElementById('searchResultsDesktop') },
        { el: document.getElementById('mobileSearchInput'), results: document.getElementById('searchResultsMobile') }
      ].filter(x => x.el && x.results);

      if (!inputs.length) return;

      let ALL = [];
      const BASE = location.origin + '/';

      const getLang = () => localStorage.getItem('site_lang') || localStorage.getItem('preferredLanguage') || 'ไทย';
      const fmtTHB = v => new Intl.NumberFormat('th-TH',{ style:'currency', currency:'THB', minimumFractionDigits:0, maximumFractionDigits:2 }).format(v);
      const fmtUSD = v => new Intl.NumberFormat('en-US',{ style:'currency', currency:'USD', minimumFractionDigits:0, maximumFractionDigits:2 }).format(v);

      const toUSD = (thb) => {
        if (!Number.isFinite(thb)) return null;
        const satang = Math.round(thb * 100);
        const cents  = Math.ceil(satang / EXCHANGE);
        return cents / 100;
      };

      const priceText = (p)=>{
        if (typeof p === 'number' && !isNaN(p)){
          return (getLang()==='English') ? fmtUSD(toUSD(p)) : fmtTHB(p);
        }
        return (getLang()==='English') ? '$0.00' : '฿—';
      };

      function parseTHB(raw){
        if (raw == null) return null;
        const s = String(raw).replace(/[^\d.]/g,'');
        if (!s) return null;
        const n = parseFloat(s);
        return Number.isFinite(n) ? n : null;
      }

      const slugify = (name)=> String(name||'').toLowerCase().trim()
        .replace(/[\/\s]+/g,'-').replace(/[^\u0E00-\u0E7Fa-z0-9\-]+/gi,'')
        .replace(/-+/g,'-').replace(/^-|-$/g,'');

      function buildHref(item){
        const name = (item.name || '').trim();
        const urlParams = new URLSearchParams({
          slug: slugify(name),
          name: name,
          image: item.image || '',
          columnJ: item.columnJ || '',
          price: (typeof item.price === 'number' && !isNaN(item.price)) ? String(item.price) : ''
        });
        return BASE.replace(/\/+$/,'/') + 'product?' + urlParams.toString();
      }

      function ensureData(){
        if (ALL.length) return;
        const src = Array.isArray(window.PRODUCTS) ? window.PRODUCTS : [];
        ALL = src.map(x => ({
          name: x.name || '',
          category: x.category || '',
          image: x.image || x.pic || '',
          price: parseTHB(x.webpriceTHB),
          columnJ: x.columnJ || ''
        }))
        .filter(x => x.name && (x.image || x.price != null));
      }

      function searchLocal(q){
        const s = q.trim().toLowerCase();
        if (s.length < 3) return [];
        const tokens = s.split(/\s+/).filter(Boolean);
        const ok = (item)=>{
          const name = String(item.name || '').toLowerCase();
          const cat  = String(item.category || '').toLowerCase();
          return tokens.every(t => name.includes(t) || cat.includes(t));
        };
        return ALL.filter(ok).slice(0, 50);
      }

      function renderDropdown(target, list){
        const dd = target.results;
        dd.innerHTML = '';

        if (!list.length){
          dd.innerHTML = `<div class="px-3 py-2 text-sm text-gray-500">ไม่พบผลลัพธ์</div>`;
          dd.classList.remove('hidden');
          return;
        }

        list.slice(0, 10).forEach(it=>{
          const href = buildHref(it);
          const name = (it.name || '').trim() || '—';
          const cat  = (it.category || '').trim() || '';
          const img  = it.image || '';
          const price= priceText(it.price);

          const row = document.createElement('a');
          row.href = href;
          row.className = 'flex gap-3 items-center px-3 py-2 hover:bg-orange-50 transition-colors';
          row.innerHTML = `
            <div class="h-10 w-10 rounded border bg-gray-50 overflow-hidden flex-shrink-0">
              ${img ? `<img src="${img}" alt="" class="w-full h-full object-cover">` : ''}
            </div>
            <div class="min-w-0 flex-1">
              <div class="text-sm text-gray-800 truncate">${name}</div>
              <div class="text-xs text-gray-500 truncate">${cat}</div>
            </div>
            <div class="text-sm font-semibold text-[var(--brand)] ml-2">${price}</div>
          `;
          dd.appendChild(row);
        });

        dd.classList.remove('hidden');
      }

      const inputsCfg = [
        { el: document.getElementById('globalSearch'), results: document.getElementById('searchResultsDesktop') },
        { el: document.getElementById('mobileSearchInput'), results: document.getElementById('searchResultsMobile') }
      ].filter(x => x.el && x.results);

      inputsCfg.forEach(target=>{
        let timer=null;
        target.el.addEventListener('input', ()=>{
          const q = target.el.value;
          clearTimeout(timer);
          timer = setTimeout(()=>{
            if (q.trim().length < 3){ target.results.classList.add('hidden'); return; }
            ensureData();
            const results = searchLocal(q);
            renderDropdown(target, results);
          }, 220);
        });

        document.addEventListener('click', (e)=>{
          if (!e.target.closest(`#${target.results.id}, #${target.el.id}`)){
            target.results.classList.add('hidden');
          }
        });
      });
    })();
  </script>

  <!-- ===== preload JSON จาก Controller/Route ===== -->
  <script>
    window.FLASH_DEALS = [];
    window.PRODUCTS    = [];
  </script>

  <!-- ===== Cart Badge Sync ===== -->
  <script>
  (function(){
    const LS_KEY = 'cartV1';
    const load = () => { try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch { return []; } };
    const totalQty = () => load().reduce((s,it)=> s + (Number(it.qty)||1), 0);

    function updateCartBadge(){
      const badge = document.querySelector('a[aria-label="cart"] span');
      if(!badge) return;
      const n = totalQty();
      badge.textContent = String(n);
      badge.style.transform = 'scale(1.15)';
      setTimeout(()=> badge.style.transform = 'scale(1)', 130);
    }

    window.addEventListener('storage', (e)=>{
      if (e.key === LS_KEY || e.key === '__cart_changed__'){ updateCartBadge(); }
    });
    document.addEventListener('DOMContentLoaded', updateCartBadge);
  })();
  </script>

  <!-- ===== Minimal toggles/drawer ===== -->
  <script>
    (function () {
      document.querySelectorAll('[data-collapse-toggle]').forEach(btn => {
        const targetSel = btn.getAttribute('data-collapse-toggle');
        const target = document.querySelector(targetSel);
        if (!target) return;
        btn.addEventListener('click', () => {
          const isHidden = target.classList.contains('hidden');
          target.classList.toggle('hidden');
          btn.setAttribute('aria-expanded', String(isHidden));
        });
      });

      const openers = document.querySelectorAll('[data-drawer-toggle]');
      const closers = document.querySelectorAll('[data-drawer-close]');
      function openDrawer(sel) {
        const wrap = document.querySelector(sel);
        if (!wrap) return;
        const drawer = wrap.querySelector('aside');
        wrap.classList.remove('hidden');
        requestAnimationFrame(() => drawer.classList.remove('translate-x-full'));
        const closeBtn = wrap.querySelector('[data-drawer-close]');
        if (closeBtn) closeBtn.focus();
        function onEsc(e){ if (e.key === 'Escape') closeDrawer(sel, true); }
        wrap._escHandler = onEsc;
        document.addEventListener('keydown', onEsc);
      }
      function closeDrawer(sel, fromEsc=false) {
        const wrap = document.querySelector(sel);
        if (!wrap) return;
        const drawer = wrap.querySelector('aside');
        drawer.classList.add('translate-x-full');
        drawer.addEventListener('transitionend', function onEnd() {
          wrap.classList.add('hidden');
          drawer.removeEventListener('transitionend', onEnd);
        }, { once: true });
        if (wrap._escHandler) {
          document.removeEventListener('keydown', wrap._escHandler);
          wrap._escHandler = null;
        }
        if (!fromEsc) {
          const opener = document.querySelector(`[data-drawer-toggle="${sel}"]`);
          if (opener) opener.focus();
        }
      }
      openers.forEach(btn => {
        const sel = btn.getAttribute('data-drawer-toggle');
        btn.addEventListener('click', () => {
          const wrap = document.querySelector(sel);
          const drawer = wrap && wrap.querySelector('aside');
          const isClosed = drawer && drawer.classList.contains('translate-x-full');
          if (isClosed) openDrawer(sel); else closeDrawer(sel);
          btn.setAttribute('aria-expanded', String(isClosed));
        });
      });
      closers.forEach(btn => {
        const sel = btn.getAttribute('data-drawer-close');
        btn.addEventListener('click', () => closeDrawer(sel));
      });
    })();
  </script>

</body>
</html>
